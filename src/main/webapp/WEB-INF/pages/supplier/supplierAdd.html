<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <title>供应商添加</title>
    <!-- 引入 BootStrap 全家桶 -->
    <script src="../res/js/jquery-3.2.1.min.js"></script>
    <script src="../res/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="../res/css/bootstrap.min.css"/>

    <!-- 引入Vue.js -->
    <script src="../res/js/vue.min.js"></script>
    <style>
        html,body{
            height: 100%;width: 100%;padding: 0px;
        }
        .hr{
            border: none;border-bottom: 1px solid #9d9d9d;
        }
        .form-group > input{
            width: 225px;
        }


        .btn-submit{
            width: 200px;
        }
        @media (min-width: 768px) {
            .from-line{
                margin-bottom: 40px;
            }
            .line-sp{
                margin-left: 50px;
            }
            .item{
                position: relative;
            }
        }
    </style>
</head>
<body>
    <div class="app container-fluid width-100per top-content">
        <ul class="breadcrumb">
            <li>
                供应商管理<span class="divider">></span>
            </li>
            <li class="active">供应商添加</li>
        </ul><br>
        <form role="form">
            <span class="h4 text-primary">供应商基本信息添加</span>
            <hr class="hr">
            <div class="row">
                <div class="col-sm-9">
                    <div class="row item">
                        <div class="col-sm-4">
                            <div class="form-group form-inline from-line has-error">
                                <label for="supplierName">名称：</label><input type="text" class="form-control " id="supplierName" v-model="supplierName" placeholder="请输入供应商名称...">
                            </div>
                        </div>
                        <span class="width"></span>
                        <div class="col-sm-4">
                            <div class="form-group form-inline from-line">
                                <label for="adtitude" class="">资质：</label><input type="text" class="form-control" id="adtitude" v-model="adtitude" placeholder="请输入供应商资质...">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-9">
                    <div class="row">
                        <div class="col-sm-4">
                            <div class="form-group form-inline from-line">
                                <label for="address">地址：</label><input type="text" class="form-control" v-model="address" id="address" placeholder="请输入供应商地址...">
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="form-group form-inline from-line">
                                <label for="contactPerson" class="">联系人：</label><input type="text" v-model="contact" class="form-control" id="contactPerson" placeholder="请输入供应商联系人...">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-9">
                    <div class="row">
                        <div class="col-sm-4">
                            <div class="form-group form-inline from-line">
                                <label for="tel">联系电话：</label><input type="text" class="form-control" v-model="tel" id="tel" placeholder="请输入供应商联系电话...">
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="form-group form-inline from-line">
                                <label for="business" class="">主营业务：</label><input type="text" class="form-control" v-model="business" id="business" placeholder="请输入供应商主营业务...">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <span class="h4 text-primary">员工自定义信息添加</span>
            <hr class="hr">
            <input type="hidden" name="customKey">
            <input type="hidden" name="customValue">
            <div class="form-group form-inline" v-for="(item,index) in customFields">
                <input type="text" class="form-control" v-model="customFields[index].key" placeholder="自定义属性">
                <input type="text" class="form-control" v-model="customFields[index].value" placeholder="属性值">
                <span class="btn btn-sm btn-danger glyphicon glyphicon-minus" @click="delField(index)"></span>
                <span class="btn btn-sm btn-primary glyphicon glyphicon-plus" v-if="index==(customFields.length-1)" @click="addField(index,customFields[index])"></span>
            </div>
            <input type="button" class="btn btn-primary btn-submit" @click="submitData()" value="提交">
        </form>
    </div>
</body>
<script>
    var data = {
        customFields:[{}],
        supplierName:"",
        adtitude:"",
        address:"",
        contact:"",
        tel:"",
        business:"",
        errorType:{}
    };
    var vm = new Vue({
        el:'.app',
        data:data,
        methods:{
            addField(index,item){
                console.log(this.customFields[index].key);
                console.log(item.value);
                this.customFields.push({});
            },
            delField(index){
                if(this.customFields.length==1){
                    return;
                }
                this.customFields.splice(index,1);
            },
            submitData(){
                var _customFields ="";
                var index;
                for(index in this.customFields){
                    _customFields+=(this.customFields[index].key+"="+this.customFields[index].value+";");
                }
                var _business=encodeURIComponent(this.business);
                var _contact=encodeURIComponent(this.contact);
                var _address=encodeURIComponent(this.address);
                var _adtitude=encodeURIComponent(this.adtitude);
                var _supplierName=encodeURIComponent(this.supplierName);
                _customFields=encodeURIComponent(_customFields);
                $.post("add",
                    {
                        "business":_business,
                        "tel":this.tel,
                        "contactName":_contact,
                        "address":_address,
                        "adtitude":_adtitude,
                        "name":_supplierName,
                        "customMessage":_customFields
                    },
                    function(data,status){
                        alert(data);
                    });
            }
        }
    });
    $('.form-control').popover();
</script>
</html>